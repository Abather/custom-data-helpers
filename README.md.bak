# Custom Data Helpers for Laravel

[![Latest Version on Packagist](https://img.shields.io/packagist/v/abather/custom-data-helpers.svg?style=flat-square)](https://packagist.org/packages/abather/custom-data-helpers)
[![GitHub Tests Action Status](https://img.shields.io/github/actions/workflow/status/abather/custom-data-helpers/run-tests.yml?branch=main&label=tests&style=flat-square)](https://github.com/abather/custom-data-helpers/actions?query=workflow%3Arun-tests+branch%3Amain)
[![GitHub Code Style Action Status](https://img.shields.io/github/actions/workflow/status/abather/custom-data-helpers/fix-php-code-style-issues.yml?branch=main&label=code%20style&style=flat-square)](https://github.com/abather/custom-data-helpers/actions?query=workflow%3A"Fix+PHP+code+style+issues"+branch%3Amain)
[![Total Downloads](https://img.shields.io/packagist/dt/abather/custom-data-helpers.svg?style=flat-square)](https://packagist.org/packages/abather/custom-data-helpers)

## Description

This Laravel package extends the default data helper functions (`data_get`, `data_set`, `data_forget`, `data_has`) to support **custom separators** instead of the hardcoded dot (`.`) notation.

Laravel's built-in data helpers are fantastic, but they use a fixed dot separator which can cause issues when your data keys contain actual dots. This package solves that problem by allowing you to specify any separator you want.

### The Problem

```php
// Your data has keys with dots in them
$data = [
    'user.name' => 'John Doe',
    'user.email' => 'john@example.com',
    'config.app.name' => 'My App'
];

// Laravel's default data_get won't work as expected
data_get($data, 'user.name'); // Returns null (looks for nested structure)
```

### The Solution

```php
// Use a custom separator to avoid conflicts
data_get($data, 'user.name', default: null, separator: '/'); // Returns 'John Doe'

// Or use different separators based on your needs
data_get($nested, 'products->desk->price', separator: '->'); // Clean, readable paths
data_get($paths, 'api/v1/users', separator: '/'); // URL-style paths
```

## Why Use This Package?

| Scenario | Laravel Default | With Custom Separators |
|----------|----------------|------------------------|
| Keys with dots | ❌ Doesn't work | ✅ Works perfectly |
| Custom path styles | ❌ Limited to dots | ✅ Use any separator |
| URL-style paths | ❌ Awkward with dots | ✅ Natural with `/` |
| Object notation | ❌ Fixed syntax | ✅ Clean `->` syntax |
| Readability | ⚠️ Can be confusing | ✅ Clear intent |

## Installation

You can install the package via composer:

```bash
composer require abather/custom-data-helpers
```

That's it! The package will auto-register itself in Laravel and the helper functions will be available globally.

## Usage

All the data helper functions work exactly like Laravel's built-in helpers, but with an additional optional `$separator` parameter.

### `data_get()` - Retrieve Values

Retrieve a value from a nested array or object using a custom separator.

```php
// Basic usage with default dot separator (backward compatible)
$data = ['products' => ['desk' => ['price' => 100]]];
data_get($data, 'products.desk.price'); // 100

// Using custom separator
$data = ['products' => ['desk' => ['price' => 100]]];
data_get($data, 'products/desk/price', separator: '/'); // 100

// With default value
data_get($data, 'products/desk/discount', default: 0, separator: '/'); // 0

// Using wildcards to get multiple values
$data = [
    'products' => [
        ['name' => 'Desk', 'price' => 100],
        ['name' => 'Chair', 'price' => 50]
    ]
];
data_get($data, 'products/*/price', separator: '/'); // [100, 50]

// Using placeholders
$flight = [
    'segments' => [
        ['from' => 'LHR', 'to' => 'IST'],
        ['from' => 'IST', 'to' => 'PKX'],
    ]
];
data_get($flight, 'segments->{first}->from', separator: '->'); // 'LHR'
data_get($flight, 'segments->{last}->to', separator: '->'); // 'PKX'
```

### `data_set()` - Set Values

Set a value within a nested array or object using a custom separator.

```php
$data = [];

// Basic usage
data_set($data, 'products|desk|price', 200, separator: '|');
// Result: ['products' => ['desk' => ['price' => 200]]]

// Using wildcards for bulk updates
$products = [
    ['name' => 'Desk', 'price' => 100],
    ['name' => 'Chair', 'price' => 50]
];
data_set($products, '*/price', 0, separator: '/');
// Sets all product prices to 0

// Conditional setting (don't overwrite existing values)
$data = ['products' => ['desk' => ['price' => 100]]];
data_set($data, 'products.desk.price', 200, overwrite: false);
// Price remains 100

// Overwrite existing values (default behavior)
data_set($data, 'products.desk.price', 200, overwrite: true);
// Price is now 200
```

### `data_has()` - Check if Key Exists

Check if a key exists in an array or object using a custom separator.

```php
$data = ['products' => ['desk' => ['price' => 100]]];

// Basic usage
data_has($data, 'products.desk.price'); // true
data_has($data, 'products.desk.discount'); // false

// Using custom separator
data_has($data, 'products->desk->price', '->'); // true

// Works with nested objects
$object = (object) [
    'user' => (object) [
        'profile' => (object) ['name' => 'John']
    ]
];
data_has($object, 'user/profile/name', '/'); // true
```

### `data_forget()` - Remove Values

Remove a value from a nested array or object using a custom separator.

```php
$data = ['products' => ['desk' => ['price' => 100, 'stock' => 50]]];

// Basic usage
data_forget($data, 'products.desk.price');
// Result: ['products' => ['desk' => ['stock' => 50]]]

// Using custom separator
data_forget($data, 'products|desk|stock', '|');
// Result: ['products' => ['desk' => []]]

// Using wildcards to remove from multiple items
$products = [
    ['name' => 'Desk', 'price' => 100, 'discount' => 10],
    ['name' => 'Chair', 'price' => 50, 'discount' => 5]
];
data_forget($products, '*/discount', '/');
// Removes 'discount' from all products
```

## Real-World Use Cases

### 1. Working with Keys Containing Dots

```php
// API response with dotted keys
$config = [
    'app.name' => 'My Application',
    'app.env' => 'production',
    'database.host' => 'localhost'
];

// Access them safely using a different separator
$appName = data_get($config, 'app.name', separator: '|'); // 'My Application'
```

### 2. URL-Style Paths

```php
$routes = [
    'api' => [
        'v1' => [
            'users' => 'UsersController@index'
        ]
    ]
];

$controller = data_get($routes, 'api/v1/users', separator: '/');
// 'UsersController@index'
```

### 3. Object Notation Style

```php
$data = [
    'user' => [
        'profile' => [
            'settings' => [
                'theme' => 'dark'
            ]
        ]
    ]
];

$theme = data_get($data, 'user->profile->settings->theme', separator: '->');
// 'dark'
```

## Backward Compatibility

All functions maintain 100% backward compatibility with Laravel's default helpers. If you don't specify a separator, they work exactly like Laravel's built-in helpers with dot notation.

```php
// These work identically to Laravel's default helpers
data_get($array, 'user.name');
data_set($array, 'user.email', 'john@example.com');
data_has($array, 'user.profile');
data_forget($array, 'user.settings');
```

## Features

- ✅ Custom separator support for all data helpers
- ✅ Wildcard operations (`*`)
- ✅ Placeholder support (`{first}`, `{last}`)
- ✅ Works with arrays and objects
- ✅ Laravel Collections support
- ✅ 100% backward compatible with Laravel's default helpers
- ✅ No configuration needed
- ✅ Auto-discovery enabled
- ✅ Fully tested

## Requirements

- PHP 8.4 or higher
- Laravel 11.x or 12.x

## Testing

```bash
composer test
```

## Changelog

Please see [CHANGELOG](CHANGELOG.md) for more information on what has changed recently.

## Contributing

Please see [CONTRIBUTING](CONTRIBUTING.md) for details.

## Security Vulnerabilities

Please review [our security policy](../../security/policy) on how to report security vulnerabilities.

## Credits

- [Abather](https://github.com/Abather)
- [All Contributors](../../contributors)

## License

The MIT License (MIT). Please see [License File](LICENSE.md) for more information.
